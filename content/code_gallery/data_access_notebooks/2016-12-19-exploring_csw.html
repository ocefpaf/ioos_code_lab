
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>How to search the IOOS CSW catalog with Python tools &#8212; The U.S. Integrated Ocean Observing System (IOOS)</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../../_static/IOOS_logo.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Accessing glider data via the Glider DAC API with Python" href="2016-12-20-searching_glider_deployments.html" />
    <link rel="prev" title="Plotting Glider data with Python tools" href="2016-11-15-glider_data_example.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      <img src="../../../_static/IOOS_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The U.S. Integrated Ocean Observing System (IOOS)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Code Gallery
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../data_access.html">
   Data Access
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="2016-10-12-fetching_data.html">
     Fetching data from CO-OPS SOS with Python tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2016-11-15-glider_data_example.html">
     Plotting Glider data with Python tools
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     How to search the IOOS CSW catalog with Python tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2016-12-20-searching_glider_deployments.html">
     Accessing glider data via the Glider DAC API with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2016-12-22-boston_light_swim.html">
     The Boston Light Swim temperature analysis with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-01-18-siphon-explore-thredds.html">
     Exploring the THREDDS catalog with Unidata’s Siphon
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-03-21-ERDDAP_IOOS_Sensor_Map.html">
     Read realtime data from IOOS Sensor Map via ERDDAP tabledap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-06-12-NCEI_RA_archive_history.html">
     Using NCEI geoportal REST API to collect information about IOOS Regional Association archived data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-07-25-HFRadar_currents.html">
     Near real-time HF-Radar currents in the proximity of the Deepwater Horizon site
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-08-01-xtractoR.html">
     Using the
     <code class="docutils literal notranslate">
      <span class="pre">
       xtractomatic
      </span>
     </code>
     R package to track Pacific Blue Marlin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-09-09-hurricane_irma.html">
     Exploring the NHC Advisories and Sea Surface Height during Hurricane Irma
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-11-30-rerddap.html">
     Calling R libraries from Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2017-12-15-finding_HFRadar_currents.html">
     Fetching data from a CSW catalog with Python tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2018-03-01-erddapy.html">
     erddapy: a python client/URL builder for ERDDAP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2019-02-26-hurricane_gis_part01.html">
     Accessing data from SOS using NHC GIS files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2019-03-08-grids-temperature.html">
     IOOS models: Temperature Horizontal Slices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2019-05-27-hurricane_gis_part02.html">
     Accessing data from SOS using NHC GIS files
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../data_analysis_and_visualization.html">
   Data Analysis And Visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_analysis_and_visualization_notebooks/2016-11-16-CF-UGRID-SGRID-conventions.html">
     Parsing Conventions and standards with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_analysis_and_visualization_notebooks/2017-01-23-R-notebook.html">
     Quick demonstration of R-notebooks using the r-oce library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_analysis_and_visualization_notebooks/2017-03-30-octave_notebook_example.html">
     A Matlab notebook primer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_analysis_and_visualization_notebooks/2018-03-15-ssh-skillscore.html">
     Investigating ocean models skill for sea surface height with IOOS catalog and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_analysis_and_visualization_notebooks/2018-03-30-wave_height_assessment.html">
     Coastal Ocean Wave Height Assessment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_analysis_and_visualization_notebooks/2018-12-04-grids.html">
     IOOS models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_analysis_and_visualization_notebooks/2020-02-14-QARTOD_ioos_qc_Water-Level-Example.html">
     IOOS QARTOD software (ioos_qc)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../data_management.html">
   Data Management
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_management_notebooks/2017-05-14-running_compliance_checker.html">
     Shore Station Compliance Checker Script
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_management_notebooks/2017-11-01-Creating-Archives-Using-Bagit.html">
     Using BagIt to tag oceanographic data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_management_notebooks/2018-02-20-obis.html">
     Using r-obistools and r-obis to explore the OBIS database
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_management_notebooks/2018-02-27-pocean-timeSeries-demo.html">
     Creating a CF-1.6 timeSeries using pocean
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_management_notebooks/2020-10-10-GTS.html">
     IOOS GTS Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data_management_notebooks/2020-12-08-DataToDwC.html">
     Aligning Data to Darwin Core
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Video Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Video_Demo_Markdown/glos.html">
   GLOS Links
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Video_Demo_Markdown/ioos.html">
   IOOS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Video_Demo_Markdown/nanoos.html">
   NANOOS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Video_Demo_Markdown/ooi.html">
   OOI Demonstration Videos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Video_Demo_Markdown/python_dem.html">
   Python Demonstration Videos
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Other Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ioos_installation_conda.html">
   Installing the IOOS Conda Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://help.aodn.org.au/aodn-data-tools/user-code-library/">
   Opening netCDF files - hints from AODN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://unidata.github.io/notebook-gallery/">
   Unidata Jupyter Notebook Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://iobis.org/tutorial/">
   Extracting and Enriching OBIS data with R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/USGS-R">
   USGS-R Examples
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Contact Us
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../contact_us.html">
   Contact Us
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <a href="https://ioos.us">IOOS</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/code_gallery/data_access_notebooks/2016-12-19-exploring_csw.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ioos/ioos_code_lab"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ioos/ioos_code_lab/issues/new?title=Issue%20on%20page%20%2Fcontent/code_gallery/data_access_notebooks/2016-12-19-exploring_csw.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://binder.pangeo.io/v2/gh/ioos/ioos_code_lab/master?urlpath=lab/tree/jupyterbook/content/code_gallery/data_access_notebooks/2016-12-19-exploring_csw.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/ioos/ioos_code_lab/blob/master/jupyterbook/content/code_gallery/data_access_notebooks/2016-12-19-exploring_csw.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="how-to-search-the-ioos-csw-catalog-with-python-tools">
<h1>How to search the IOOS CSW catalog with Python tools<a class="headerlink" href="#how-to-search-the-ioos-csw-catalog-with-python-tools" title="Permalink to this headline">¶</a></h1>
<p>This notebook demonstrates a how to query the IOOS Catalog <a class="reference external" href="https://en.wikipedia.org/wiki/Catalog_Service_for_the_Web">Catalog Service for the Web (CSW)</a>, parse resulting records to obtain web data service endpoints, and retrieve data from these service endpoints.</p>
<p>Let’s start by creating the search filters.
The filter used here constraints the search on a certain geographical region (bounding box), a time span (last week), and some <a class="reference external" href="http://cfconventions.org/Data/cf-standard-names/37/build/cf-standard-name-table.html">CF</a> variable standard names that represent sea surface temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Region: Northwest coast.</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">127</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="o">-</span><span class="mf">123.75</span><span class="p">,</span> <span class="mi">48</span><span class="p">]</span>
<span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lon</span> <span class="o">=</span> <span class="o">-</span><span class="mi">127</span><span class="p">,</span> <span class="o">-</span><span class="mf">123.75</span>
<span class="n">min_lat</span><span class="p">,</span> <span class="n">max_lat</span> <span class="o">=</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">48</span>

<span class="n">bbox</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_lon</span><span class="p">,</span> <span class="n">min_lat</span><span class="p">,</span> <span class="n">max_lon</span><span class="p">,</span> <span class="n">max_lat</span><span class="p">]</span>
<span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;urn:ogc:def:crs:OGC:1.3:CRS84&quot;</span>

<span class="c1"># Temporal range of 1 week.</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">stop</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Sea surface temperature CF names.</span>
<span class="n">cf_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;sea_water_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sea_surface_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sea_water_potential_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;equivalent_potential_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sea_water_conservative_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pseudo_equivalent_potential_temperature&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>With these 3 elements it is possible to assemble a <a class="reference external" href="http://www.opengeospatial.org/standards/filter">OGC Filter Encoding (FE)</a> using the <code class="docutils literal notranslate"><span class="pre">owslib.fes</span></code>* module.</p>
<p>* OWSLib is a Python package for client programming with Open Geospatial Consortium (OGC) web service (hence OWS) interface standards, and their related content models.</p>
<p>Although CSW has a built-in feature to find datasets within a specified bounding box, it doesn’t have a feature to find datasets within a specified time interval. We therefore create the function <code class="docutils literal notranslate"><span class="pre">fes_date_filter</span></code> below that finds all datasets that have at least part of their data within the specified interval.  So we find all datasets that start before the end of the interval and stop after the beginning of the interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">owslib</span> <span class="kn">import</span> <span class="n">fes</span>


<span class="k">def</span> <span class="nf">fes_date_filter</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="s2">&quot;overlaps&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take datetime-like objects and returns a fes filter for date range</span>
<span class="sd">    (begin and end inclusive).</span>
<span class="sd">    NOTE: Truncates the minutes!!!</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from datetime import datetime, timedelta</span>
<span class="sd">    &gt;&gt;&gt; stop = datetime(2010, 1, 1, 12, 30, 59).replace(tzinfo=pytz.utc)</span>
<span class="sd">    &gt;&gt;&gt; start = stop - timedelta(days=7)</span>
<span class="sd">    &gt;&gt;&gt; begin, end = fes_date_filter(start, stop, constraint=&#39;overlaps&#39;)</span>
<span class="sd">    &gt;&gt;&gt; begin.literal, end.literal</span>
<span class="sd">    (&#39;2010-01-01 12:00&#39;, &#39;2009-12-25 12:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; begin.propertyoperator, end.propertyoperator</span>
<span class="sd">    (&#39;ogc:PropertyIsLessThanOrEqualTo&#39;, &#39;ogc:PropertyIsGreaterThanOrEqualTo&#39;)</span>
<span class="sd">    &gt;&gt;&gt; begin, end = fes_date_filter(start, stop, constraint=&#39;within&#39;)</span>
<span class="sd">    &gt;&gt;&gt; begin.literal, end.literal</span>
<span class="sd">    (&#39;2009-12-25 12:00&#39;, &#39;2010-01-01 12:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; begin.propertyoperator, end.propertyoperator</span>
<span class="sd">    (&#39;ogc:PropertyIsGreaterThanOrEqualTo&#39;, &#39;ogc:PropertyIsLessThanOrEqualTo&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:00&quot;</span><span class="p">)</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="n">stop</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:00&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">constraint</span> <span class="o">==</span> <span class="s2">&quot;overlaps&quot;</span><span class="p">:</span>
        <span class="n">propertyname</span> <span class="o">=</span> <span class="s2">&quot;apiso:TempExtent_begin&quot;</span>
        <span class="n">begin</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLessThanOrEqualTo</span><span class="p">(</span><span class="n">propertyname</span><span class="o">=</span><span class="n">propertyname</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">stop</span><span class="p">)</span>
        <span class="n">propertyname</span> <span class="o">=</span> <span class="s2">&quot;apiso:TempExtent_end&quot;</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsGreaterThanOrEqualTo</span><span class="p">(</span>
            <span class="n">propertyname</span><span class="o">=</span><span class="n">propertyname</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">start</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">constraint</span> <span class="o">==</span> <span class="s2">&quot;within&quot;</span><span class="p">:</span>
        <span class="n">propertyname</span> <span class="o">=</span> <span class="s2">&quot;apiso:TempExtent_begin&quot;</span>
        <span class="n">begin</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsGreaterThanOrEqualTo</span><span class="p">(</span>
            <span class="n">propertyname</span><span class="o">=</span><span class="n">propertyname</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">start</span>
        <span class="p">)</span>
        <span class="n">propertyname</span> <span class="o">=</span> <span class="s2">&quot;apiso:TempExtent_end&quot;</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLessThanOrEqualTo</span><span class="p">(</span><span class="n">propertyname</span><span class="o">=</span><span class="n">propertyname</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">stop</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Unrecognized constraint </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">constraint</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">wildCard</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">escapeChar</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">singleChar</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">propertyname</span><span class="o">=</span><span class="s2">&quot;apiso:AnyText&quot;</span><span class="p">)</span>

<span class="n">or_filt</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">Or</span><span class="p">([</span><span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLike</span><span class="p">(</span><span class="n">literal</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;*</span><span class="si">%s</span><span class="s2">*&quot;</span> <span class="o">%</span> <span class="n">val</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">cf_names</span><span class="p">])</span>

<span class="n">begin</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">fes_date_filter</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
<span class="n">bbox_crs</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">BBox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

<span class="n">filter_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">fes</span><span class="o">.</span><span class="n">And</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">bbox_crs</span><span class="p">,</span>  <span class="c1"># bounding box</span>
            <span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="p">,</span>  <span class="c1"># start and end date</span>
            <span class="n">or_filt</span><span class="p">,</span>  <span class="c1"># or conditions (CF variable names)</span>
        <span class="p">]</span>
    <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">owslib.csw</span> <span class="kn">import</span> <span class="n">CatalogueServiceWeb</span>

<span class="n">endpoint</span> <span class="o">=</span> <span class="s2">&quot;https://data.ioos.us/csw&quot;</span>

<span class="n">csw</span> <span class="o">=</span> <span class="n">CatalogueServiceWeb</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We have created a <code class="docutils literal notranslate"><span class="pre">csw</span></code> object, but nothing has been searched yet.</p>
<p>Below we create a <code class="docutils literal notranslate"><span class="pre">get_csw_records</span></code> function that calls the OSWLib method <code class="docutils literal notranslate"><span class="pre">getrecords2</span></code> iteratively to retrieve all the records matching the search criteria specified by the <code class="docutils literal notranslate"><span class="pre">filter_list</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_csw_records</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">maxrecords</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Iterate `maxrecords`/`pagesize` times until the requested value in</span>
<span class="sd">    `maxrecords` is reached.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">owslib.fes</span> <span class="kn">import</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">SortProperty</span>

    <span class="c1"># Iterate over sorted results.</span>
    <span class="n">sortby</span> <span class="o">=</span> <span class="n">SortBy</span><span class="p">([</span><span class="n">SortProperty</span><span class="p">(</span><span class="s2">&quot;dc:title&quot;</span><span class="p">,</span> <span class="s2">&quot;ASC&quot;</span><span class="p">)])</span>
    <span class="n">csw_records</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">startposition</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nextrecord</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">nextrecord</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">csw</span><span class="o">.</span><span class="n">getrecords2</span><span class="p">(</span>
            <span class="n">constraints</span><span class="o">=</span><span class="n">filter_list</span><span class="p">,</span>
            <span class="n">startposition</span><span class="o">=</span><span class="n">startposition</span><span class="p">,</span>
            <span class="n">maxrecords</span><span class="o">=</span><span class="n">pagesize</span><span class="p">,</span>
            <span class="n">sortby</span><span class="o">=</span><span class="n">sortby</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">csw_records</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">csw</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;nextrecord&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">startposition</span> <span class="o">+=</span> <span class="n">pagesize</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Last one is included.</span>
        <span class="k">if</span> <span class="n">startposition</span> <span class="o">&gt;=</span> <span class="n">maxrecords</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">csw_records</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_csw_records</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">maxrecords</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">records</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">{}</span><span class="s2"> records.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;[</span><span class="si">{}</span><span class="s2">]</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 70 records.

[SATURN Estuary Station #07, Baker Bay, WA]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46116

[STONEWALL BANK - 20NM West of Newport, OR]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46050

[TILLAMOOK, OR - 85 NM WNW of Tillamook, OR]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46089

[UCSC California Current System ROMS Nowcast 10km]
UCSC

[UMPQUA OFFSHORE, OR (139)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46229

[UNH Appledore Island CO2]
UNH_WBD

[urn:ioos:station:NOAA.NOS.CO-OPS:9435380 station, South Beach, OR]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9435380

[urn:ioos:station:NOAA.NOS.CO-OPS:9440581 station, Cape Disappointment, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9440581

[urn:ioos:station:NOAA.NOS.CO-OPS:9440910 station, Toke Point, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9440910

[urn:ioos:station:NOAA.NOS.CO-OPS:9442396 station, La Push, Quillayute River, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9442396

[Astoria Canyon, OR  (179)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46248

[CAPE ELIZABETH- 45NM NW of Aberdeen, WA]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46041

[ce_312-20170419T2040-delayed]
org.oceanobservatories:ce_312-20170419T2040-delayed_f070_8f49_1646

[ce_312-20170419T2040-delayed]
ce_312-20170419T2040-delayed

[ce_319-20170410T2034]
org.oceanobservatories:ce_319-20170410T2034_f070_8f49_1646

[ce_319-20170410T2034]
ce_319-20170410T2034

[ce_319-20170410T2034-delayed]
ce_319-20170410T2034-delayed

[ce_319-20170410T2034-delayed]
org.oceanobservatories:ce_319-20170410T2034-delayed_f070_8f49_1646

[ce_320-20170410T1745]
org.oceanobservatories:ce_320-20170410T1745_f070_8f49_1646

[ce_320-20170410T1745]
ce_320-20170410T1745

[ce_320-20170410T1745-delayed]
ce_320-20170410T1745-delayed

[ce_320-20170410T1745-delayed]
org.oceanobservatories:ce_320-20170410T1745-delayed_f070_8f49_1646

[ce_382-20160410T2230]
org.oceanobservatories:ce_382-20160410T2230_f070_8f49_1646

[ce_382-20160410T2230]
ce_382-20160410T2230

[ce_382-20170410T2230]
org.oceanobservatories:ce_382-20170410T2230_f070_8f49_1646

[ce_382-20170410T2230]
ce_382-20170410T2230

[ce_382-20170410T2230-delayed]
ce_382-20170410T2230-delayed

[ce_382-20170410T2230-delayed]
org.oceanobservatories:ce_382-20170410T2230-delayed_f070_8f49_1646

[ce_383-20170131T1942]
org.oceanobservatories:ce_383-20170131T1942_f070_8f49_1646

[ce_383-20170131T1942]
ce_383-20170131T1942

[ce_383-20170131T1942-delayed]
ce_383-20170131T1942-delayed

[ce_384-20170420T0137]
ce_384-20170420T0137

[ce_384-20170420T0137]
org.oceanobservatories:ce_384-20170420T0137_f070_8f49_1646

[ce_384-20170420T0137-delayed]
ce_384-20170420T0137-delayed

[ce_384-20170420T0137-delayed]
org.oceanobservatories:ce_384-20170420T0137-delayed_f070_8f49_1646

[Cha&#39;Ba La Push]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46119

[Clatsop Spit, OR (162)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46243

[COAMPS 12-hour Total Precipitation forecast, 4km]
COAMPS_4KM_TTL_PRCP

[COAMPS Cloud Base Altitude Forecast, 4km]
COAMPS_4KM_CLD_BASE

[COAMPS Ground and Sea Surface Temperature, 4km]
COAMPS_4KM_GRND_SEA_TEMP

[COAMPS Net short wave radiation at surface, 4km]
COAMPS_4KM_SOL_RAD

[COAMPS Relative Humidity, 4km]
COAMPS_4KM_RLTV_HUM

[COAMPS Visibility Forecast, 4km]
COAMPS_4KM_VISIB

[COLUMBIA RIVER BAR - 20NM West of Columbia River Mouth]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46029

[Columbia River Entrance - SATURN Station #02 Offshore]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46096

[Destruction Island, WA]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_desw1

[Global SST &amp; Sea Ice Analysis, L4 OSTIA, 0.05 deg daily (METOFFICE-GLO-SST-L4-NRT-OBS-SST-V2)]
AOOS_OSTIA

[Grays Harbor, WA (036)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46211

[Hourly CDIP 46211 Data]
CDIP_46211

[Hourly CDIP 46229 Data]
CDIP_46229

[Hourly CDIP 46248 Data]
CDIP_46248

[Hourly NDBC 46029 data]
NDBC_46029

[Hourly NDBC 46041 data]
NDBC_46041

[Hourly NDBC 46050 data]
NDBC_46050

[Hourly NDBC 46089 data]
NDBC_46089

[Hourly NOS Astoria Met Data]
NOS_9439040_Met

[Hourly NOS Charleston Met Data]
NOS_9432780_Met

[Hourly NOS Garibaldi Met Data]
NOS_9437540_Met

[Hourly NOS Southbeach Met Data]
NOS_9435380_Met

[Hourly NOS Toke Pt Met Data]
NOS_9440910_Met

[NDBC Standard Meteorological Buoy Data, 1970-present]
cwwcNDBCMet

[Newport, OR]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_nwpo3

[NOAA Coral Reef Watch Operational Daily Near-Real-Time Global 5-km Satellite Coral Bleaching Monitoring Products]
dhw_5km

[OOI Newport Shelf]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46097

[OOI Waldport Offshore]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46098

[OOI Westport Offshore]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46100

[OOI Westport Shelf]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46099

[(OSU) NH-10 Buoy, Newport]
data.nanoos.org-urn_ioos_station_nanoos_osu_nh10

[Reedsport, OR (232)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46261

[SATURN Estuary Station #03]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_seto3
</pre></div>
</div>
</div>
</div>
<p>That search returned a lot of records!
What if we are not interested in those model results nor global dataset?
We can those be excluded  from the search with a <code class="docutils literal notranslate"><span class="pre">fes.Not</span></code> filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">wildCard</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">escapeChar</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">singleChar</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">propertyname</span><span class="o">=</span><span class="s2">&quot;apiso:AnyText&quot;</span><span class="p">)</span>


<span class="n">filter_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">fes</span><span class="o">.</span><span class="n">And</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">bbox_crs</span><span class="p">,</span>  <span class="c1"># Bounding box</span>
            <span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="p">,</span>  <span class="c1"># start and end date</span>
            <span class="n">or_filt</span><span class="p">,</span>  <span class="c1"># or conditions (CF variable names).</span>
            <span class="n">fes</span><span class="o">.</span><span class="n">Not</span><span class="p">([</span><span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLike</span><span class="p">(</span><span class="n">literal</span><span class="o">=</span><span class="s2">&quot;*NAM*&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)]),</span>  <span class="c1"># no NAM results</span>
            <span class="n">fes</span><span class="o">.</span><span class="n">Not</span><span class="p">([</span><span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLike</span><span class="p">(</span><span class="n">literal</span><span class="o">=</span><span class="s2">&quot;*CONUS*&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)]),</span>  <span class="c1"># no NAM results</span>
            <span class="n">fes</span><span class="o">.</span><span class="n">Not</span><span class="p">([</span><span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLike</span><span class="p">(</span><span class="n">literal</span><span class="o">=</span><span class="s2">&quot;*GLOBAL*&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)]),</span>  <span class="c1"># no NAM results</span>
            <span class="n">fes</span><span class="o">.</span><span class="n">Not</span><span class="p">([</span><span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLike</span><span class="p">(</span><span class="n">literal</span><span class="o">=</span><span class="s2">&quot;*ROMS*&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)]),</span>  <span class="c1"># no NAM results</span>
        <span class="p">]</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="n">get_csw_records</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">maxrecords</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">records</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">{}</span><span class="s2"> records.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;[</span><span class="si">{}</span><span class="s2">]</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 65 records.

[UNH Appledore Island CO2]
UNH_WBD

[urn:ioos:station:NOAA.NOS.CO-OPS:9435380 station, South Beach, OR]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9435380

[urn:ioos:station:NOAA.NOS.CO-OPS:9440581 station, Cape Disappointment, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9440581

[urn:ioos:station:NOAA.NOS.CO-OPS:9440910 station, Toke Point, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9440910

[urn:ioos:station:NOAA.NOS.CO-OPS:9442396 station, La Push, Quillayute River, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9442396

[Astoria Canyon, OR  (179)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46248

[CAPE ELIZABETH- 45NM NW of Aberdeen, WA]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46041

[ce_312-20170419T2040-delayed]
org.oceanobservatories:ce_312-20170419T2040-delayed_f070_8f49_1646

[ce_312-20170419T2040-delayed]
ce_312-20170419T2040-delayed

[ce_319-20170410T2034]
org.oceanobservatories:ce_319-20170410T2034_f070_8f49_1646

[ce_319-20170410T2034]
ce_319-20170410T2034

[ce_319-20170410T2034-delayed]
ce_319-20170410T2034-delayed

[ce_319-20170410T2034-delayed]
org.oceanobservatories:ce_319-20170410T2034-delayed_f070_8f49_1646

[ce_320-20170410T1745]
org.oceanobservatories:ce_320-20170410T1745_f070_8f49_1646

[ce_320-20170410T1745]
ce_320-20170410T1745

[ce_320-20170410T1745-delayed]
ce_320-20170410T1745-delayed

[ce_320-20170410T1745-delayed]
org.oceanobservatories:ce_320-20170410T1745-delayed_f070_8f49_1646

[ce_382-20160410T2230]
org.oceanobservatories:ce_382-20160410T2230_f070_8f49_1646

[ce_382-20160410T2230]
ce_382-20160410T2230

[ce_382-20170410T2230]
ce_382-20170410T2230

[ce_382-20170410T2230]
org.oceanobservatories:ce_382-20170410T2230_f070_8f49_1646

[ce_382-20170410T2230-delayed]
ce_382-20170410T2230-delayed

[ce_382-20170410T2230-delayed]
org.oceanobservatories:ce_382-20170410T2230-delayed_f070_8f49_1646

[ce_383-20170131T1942]
org.oceanobservatories:ce_383-20170131T1942_f070_8f49_1646

[ce_383-20170131T1942]
ce_383-20170131T1942

[ce_384-20170420T0137]
org.oceanobservatories:ce_384-20170420T0137_f070_8f49_1646

[ce_384-20170420T0137-delayed]
org.oceanobservatories:ce_384-20170420T0137-delayed_f070_8f49_1646

[ce_384-20170420T0137-delayed]
ce_384-20170420T0137-delayed

[Cha&#39;Ba La Push]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46119

[Clatsop Spit, OR (162)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46243

[COAMPS 12-hour Total Precipitation forecast, 4km]
COAMPS_4KM_TTL_PRCP

[COAMPS Cloud Base Altitude Forecast, 4km]
COAMPS_4KM_CLD_BASE

[COAMPS Ground and Sea Surface Temperature, 4km]
COAMPS_4KM_GRND_SEA_TEMP

[COAMPS IR_heat_flux @ surface, 4km]
COAMPS_4KM_IR_FLUX

[COAMPS Net short wave radiation at surface, 4km]
COAMPS_4KM_SOL_RAD

[COAMPS Visibility Forecast, 4km]
COAMPS_4KM_VISIB

[COLUMBIA RIVER BAR - 20NM West of Columbia River Mouth]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46029

[Columbia River Entrance - SATURN Station #02 Offshore]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46096

[Destruction Island, WA]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_desw1

[Grays Harbor, WA (036)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46211

[Hourly CDIP 46211 Data]
CDIP_46211

[Hourly CDIP 46229 Data]
CDIP_46229

[Hourly CDIP 46243 Data]
CDIP_46243

[Hourly CDIP 46248 Data]
CDIP_46248

[Hourly NDBC 46029 data]
NDBC_46029

[Hourly NDBC 46050 data]
NDBC_46050

[Hourly NDBC 46089 data]
NDBC_46089

[Hourly NOS Astoria Met Data]
NOS_9439040_Met

[Hourly NOS Charleston Met Data]
NOS_9432780_Met

[Hourly NOS Garibaldi Met Data]
NOS_9437540_Met

[Hourly NOS Southbeach Met Data]
NOS_9435380_Met

[Hourly NOS Toke Pt Met Data]
NOS_9440910_Met

[Lakeside, OR (231)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46260

[NDBC Standard Meteorological Buoy Data, 1970-present]
cwwcNDBCMet

[Newport, OR]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_nwpo3

[OOI Waldport Offshore]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46098

[OOI Westport Offshore]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46100

[OOI Westport Shelf]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46099

[(OSU) NH-10 Buoy, Newport]
data.nanoos.org-urn_ioos_station_nanoos_osu_nh10

[Reedsport, OR (232)]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46261

[SATURN Estuary Station #03]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_seto3

[SATURN Estuary Station #04 at Mott Basin]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_sefo3

[SATURN Estuary Station #07, Baker Bay, WA]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46116

[STONEWALL BANK - 20NM West of Newport, OR]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46050

[TILLAMOOK, OR - 85 NM WNW of Tillamook, OR]
sdf.ndbc.noaa.gov-urn_ioos_station_wmo_46089
</pre></div>
</div>
</div>
</div>
<p>Now we got fewer records to deal with. That’s better. But if the user is interested in only some specific service, it is better to filter by a string, like <a class="reference external" href="https://tidesandcurrents.noaa.gov/"><code class="docutils literal notranslate"><span class="pre">CO-OPS</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">fes</span><span class="o">.</span><span class="n">And</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">bbox_crs</span><span class="p">,</span>  <span class="c1"># Bounding box</span>
            <span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="p">,</span>  <span class="c1"># start and end date</span>
            <span class="n">or_filt</span><span class="p">,</span>  <span class="c1"># or conditions (CF variable names).</span>
            <span class="n">fes</span><span class="o">.</span><span class="n">PropertyIsLike</span><span class="p">(</span><span class="n">literal</span><span class="o">=</span><span class="s2">&quot;*CO-OPS*&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">),</span>  <span class="c1"># must have CO-OPS</span>
        <span class="p">]</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="n">get_csw_records</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">maxrecords</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">records</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">{}</span><span class="s2"> records.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">{}</span><span class="s2">]</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 4 records.

[urn:ioos:station:NOAA.NOS.CO-OPS:9435380 station, South Beach, OR]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9435380

[urn:ioos:station:NOAA.NOS.CO-OPS:9440581 station, Cape Disappointment, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9440581

[urn:ioos:station:NOAA.NOS.CO-OPS:9440910 station, Toke Point, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9440910

[urn:ioos:station:NOAA.NOS.CO-OPS:9442396 station, La Push, Quillayute River, WA]
opendap.co-ops.nos.noaa.gov-urn_ioos_station_NOAA.NOS.CO-OPS_9442396
</pre></div>
</div>
</div>
</div>
<p>The easiest way to get more information is to explorer the individual records.
Here is the <code class="docutils literal notranslate"><span class="pre">abstract</span></code> and <code class="docutils literal notranslate"><span class="pre">subjects</span></code> from the last station in the list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textwrap</span>

<span class="n">value</span> <span class="o">=</span> <span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">abstract</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NOAA.NOS.CO-OPS Sensor Observation Service (SOS) Server  This station
provides the following variables: Air pressure, Air temperature, Sea
surface height amplitude due to equilibrium ocean tide, Sea water
temperature, Water surface height above reference datum, Wind from
direction, Wind speed, Wind speed of gust
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">subjects</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Air Temperature
Barometric Pressure
Conductivity
Currents
Datum
Harmonic Constituents
Rain Fall
Relative Humidity
Salinity
Visibility
Water Level
Water Level Predictions
Water Temperature
Winds
air_pressure
air_temperature
sea_surface_height_amplitude_due_to_equilibrium_ocean_tide
sea_water_temperature
water_surface_height_above_reference_datum
wind_from_direction
wind_speed
wind_speed_of_gust
climatologyMeteorologyAtmosphere
</pre></div>
</div>
</div>
</div>
<p>The next step is to inspect the type services/schemes available for downloading the data. The easiest way to accomplish that is with by “sniffing” the URLs with <code class="docutils literal notranslate"><span class="pre">geolinks</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geolinks</span> <span class="kn">import</span> <span class="n">sniff_link</span>

<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;geolink: </span><span class="si">{geolink}</span><span class="se">\n</span><span class="s2">scheme: </span><span class="si">{scheme}</span><span class="se">\n</span><span class="s2">URL: </span><span class="si">{url}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span>
<span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">references</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">(</span><span class="n">geolink</span><span class="o">=</span><span class="n">sniff_link</span><span class="p">(</span><span class="n">ref</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]),</span> <span class="o">**</span><span class="n">ref</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>geolink: OGC:SOS
scheme: OGC:SOS:DescribeSensor
URL: https://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?procedure=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;version=1.0.0&amp;service=SOS&amp;outputFormat=text/xml; subtype=&quot;sensorML/1.0.1/profiles/ioos_sos/1.0&quot;&amp;request=DescribeSensor

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/air_pressure&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/air_temperature&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/sea_surface_height_amplitude_due_to_equilibrium_ocean_tide&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/sea_water_temperature&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/water_surface_height_above_reference_datum&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/wind_from_direction&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/wind_speed&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/wind_speed_of_gust&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0

geolink: OPeNDAP:OPeNDAP
scheme: WWW:LINK
URL: https://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/images/tide_gauge.jpg

geolink: None
scheme: WWW:LINK
URL: https://tidesandcurrents.noaa.gov/publications/NOAA_Technical_Report_NOS_CO-OPS_030_QC_requirements_doc(revised)-11102004.pdf

geolink: None
scheme: WWW:LINK
URL: https://tidesandcurrents.noaa.gov/stationhome.html?id=9442396

geolink: OGC:SOS
scheme: OGC:SOS
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?request=GetCapabilities&amp;service=SOS&amp;acceptVersions=1.0.0
</pre></div>
</div>
</div>
</div>
<p>There are many direct links to Comma Separated Value (<code class="docutils literal notranslate"><span class="pre">CSV</span></code>) and
eXtensible Markup Language (<code class="docutils literal notranslate"><span class="pre">XML</span></code>) responses to the various variables available in that station.</p>
<p>In addition to those links, there are three very interesting links for more information: 1.) the QC document, 2.) the station photo, 3.) the station home page.</p>
<p>For a detailed description of what those <code class="docutils literal notranslate"><span class="pre">geolink</span></code> results mean check the <a class="reference external" href="https://github.com/OSGeo/Cat-Interop/blob/master/LinkPropertyLookupTable.csv">lookup</a> table.</p>
<p>The original search was focused on sea water temperature,
so there is the need to extract only the endpoint for that variable.</p>
<p>PS: see also the <a class="reference external" href="http://ioos.github.io/notebooks_demos/notebooks/2016-10-12-fetching_data/">pyoos example</a> for fetching data from <code class="docutils literal notranslate"><span class="pre">CO-OPS</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(datetime.datetime(2017, 4, 14, 0, 0), datetime.datetime(2017, 4, 21, 0, 0))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">references</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">ref</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;csv&quot;</span> <span class="ow">in</span> <span class="n">url</span> <span class="ow">and</span> <span class="s2">&quot;sea&quot;</span> <span class="ow">in</span> <span class="n">url</span> <span class="ow">and</span> <span class="s2">&quot;temperature&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">(</span><span class="n">geolink</span><span class="o">=</span><span class="n">sniff_link</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="o">**</span><span class="n">ref</span><span class="p">))</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>geolink: OGC:SOS
scheme: WWW:LINK - text/csv
URL: http://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?observedProperty=http://mmisw.org/ont/cf/parameter/sea_water_temperature&amp;service=SOS&amp;responseFormat=text/csv&amp;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9442396&amp;eventTime=2020-07-13T15:13:35/2020-07-13T17:13:35&amp;version=1.0.0
</pre></div>
</div>
</div>
</div>
<p>Note that the URL returned by the service has some hard-coded start/stop dates.
It is easy to overwrite those with the same dates from the filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmt</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;https://opendap.co-ops.nos.noaa.gov/ioos-dif-sos/SOS?&quot;</span>
    <span class="s2">&quot;service=SOS&amp;&quot;</span>
    <span class="s2">&quot;eventTime={0:%Y-%m-</span><span class="si">%d</span><span class="s2">T00:00:00}/{1:%Y-%m-</span><span class="si">%d</span><span class="s2">T00:00:00}&amp;&quot;</span>
    <span class="s2">&quot;observedProperty=http://mmisw.org/ont/cf/parameter/sea_water_temperature&amp;&quot;</span>
    <span class="s2">&quot;version=1.0.0&amp;&quot;</span>
    <span class="s2">&quot;request=GetObservation&amp;offering=urn:ioos:station:NOAA.NOS.CO-OPS:9439040&amp;&quot;</span>
    <span class="s2">&quot;responseFormat=text/csv&quot;</span>
<span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, it is possible to download the data directly into a data <code class="docutils literal notranslate"><span class="pre">pandas</span></code> data frame and plot it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;date_time&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sea_water_temperature (C)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Sea water temperature ($^\circ$C)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;urn:ioos:station:NOAA.NOS.CO-OPS:9442396 station, La Push, Quillayute River, WA&#39;)
</pre></div>
</div>
<img alt="../../../_images/2016-12-19-exploring_csw_27_1.png" src="../../../_images/2016-12-19-exploring_csw_27_1.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/code_gallery/data_access_notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="2016-11-15-glider_data_example.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Plotting Glider data with Python tools</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="2016-12-20-searching_glider_deployments.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Accessing glider data via the Glider DAC API with Python</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By IOOS<br/>
        
          <div class="extra_footer">
            <a href=https://ioos.noaa.gov> ioos.noaa.gov </a> &nbsp <a href=https://www.facebook.com/usioosgov> Facebook </a> &nbsp <a href=https://www.twitter.com/usioosgov> Twitter </a> &nbsp <a href="mailto:data.ioos@noaa.gov">Contact Us</a> <br> U.S. Integrated Ocean Observing System Program <br> 1315 East-West Highway <br> SSMC3, 2nd Floor <br> Silver Spring, MD 20910 <br> (240) 533-9444
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-546J258RCJ"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('config', 'G-546J258RCJ');
                </script>

  </body>
</html>